extends layout

block content

  h1.h2 New Message

  if userHasNoEmail
    hr
    div.alert.alert-warning
      b.warning Warning: 
      | Your account doesn't have an email associated to it. The system requires an
      | email to be able to send check-in notifications, configure one by going to
      a.p-2.text-muted(href='/account') your account

  form(method='post', enctype="multipart/form-data")
    hr
    h1.h3.mb-3.font-weight-normal Content

    div.form-group
      label(for='recipients') Recipients
      input.form-control(name='recipients', id='recipients', placeholder='email1@gmail.com, email2@yahoo.com', required, autofocus)

    div.form-group
      label(for='subject') Subject
      input.form-control(name='subject', id='subject', placeholder='Email Subject', required)

    div.form-group
      label(for='body') Body
      textarea.form-control(name='body', id='body', rows='3', required)

    div.form-group
      a.text-muted.collapsed(data-toggle='collapse', href='#advanceEncryptionOptions')
        | Show Advanced Encryption Options
        | #{' '}
        i.fa(arial-hidden)

    div.collapse(id='advanceEncryptionOptions')
      div.form-group
        div
          label Message Body Encryption
          | #{' '}
          a.text-muted.collapsed(data-toggle='collapse', href='#encryptionInformation')
            | (Tell me more about these options
            | #{' '}
            i.fa(arial-hidden)
            | )
        div.form-check
          input.form-check-input(name='messageBodyEncryption', id='unencrypted', type='radio', value="unencrypted" checked)
          label.form-check-label(for='unencrypted') Unencrypted
        div.form-check
          input.form-check-input(name='messageBodyEncryption', id='encryptedSystemEncryptionPassword', type='radio', value="encrypted_system_encryption_password")
          label.form-check-label(for='encryptedSystemEncryptionPassword') Encrypt using system encryption password
        div.form-check
          input.form-check-input(name='messageBodyEncryption', id='encryptedCustomEncryptionPassword', type='radio', value="encrypted_custom_encryption_password")
          label.form-check-label(for='encryptedCustomEncryptionPassword') Encrypt using custom encryption password
        div.collapse(id='encryptionInformation')
          include mixins/_encryption_options_info

    div.form-group(id='customEncryptionPasswordGroup', hidden)
      label(for='customEncryptionPassword') Custom Encryption Password
      input.form-control(name='customEncryptionPassword', id='customEncryptionPassword', placeholder='Custom encryption password', type='password')

    div.form-group(id='customEncryptionPasswordHintGroup', hidden)
      label(for='customEncryptionPasswordHint') Custom Encryption Password Hint
      input.form-control(name='customEncryptionPasswordHint', id='customEncryptionPasswordHint', placeholder='Hello Bob, the encryption password is the middle name of your oldest sibling')

    div.form-group
      label(for='attachment') Attachment (max 20MB)
      input.form-control-file(name='attachment', id='attachment', type='file')

    hr
    h1.h3.mb-3.font-weight-normal Check-in Configuration

    div.form-group
      label(for='checkinFrequencyTime') Send me a check-in notification if I am absent for more than...
      div.form-row
        div.col-md-2
          input.form-control(name='checkinFrequencyTime', id='checkinFrequencyTime', required, value="6", type="number", min="1")
        div.col-md-2
          select.form-control(name='checkinFrequencyTimeUnit', id='checkinFrequencyTimeUnit', required)
            option Days
            option(selected) Months
            option Years

    div.form-group
      label(for='checkinWaitingTime') Deliver this message if I don't respond to my check-in notification after...
      div.form-row
        div.col-md-2
          input.form-control(name='checkinWaitingTime', id='checkinWaitingTime', required, value="1", type="number", min="1")
        div.col-md-2
          select.form-control(name='checkinWaitingTimeUnit', id='checkinWaitingTimeUnit', required)
            option Days
            option(selected) Months
            option Years

    hr

    div.row
      div.col-md-3
        button.btn.btn-secondary.btn-block(type='submit') Save

    include mixins/_errors

  script(src='/javascripts/messagesNew.js')
